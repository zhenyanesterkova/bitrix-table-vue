this.BX=this.BX||{},this.BX.Denvic=this.BX.Denvic||{},function(t,e,i,o,n,l,r,a){"use strict";var s;function u(t,e){t.bottomLoader=!0,e&&(t.rows=[]),s&&(clearTimeout(s),s=null),function(t){var e,i;if(t.infScrollable){if((i=(e=t.rows.length)?e+t.infScrollStepSize:t.infScrollStartSize)>=t.length)return}else t.paginable&&(i=(e=t.pageSize*(t.pageNumber-1))+t.pageSize);BX.ajax({url:"/local/ajax/denvic/ajax-vue.php",data:{sorts:t.sorts,filters:t.filters,navParams:{pageSize:t.pageSize,pageNumber:t.pageNumber,infScroll:t.infScrollable,sizeScroll:i-e,startIndex:e,endIndex:i}},method:"POST",dataType:"json",timeout:30,async:!0,processData:!0,scriptsRunFirst:!0,emulateOnload:!0,start:!0,cache:!1,onsuccess:function(e){console.log(e),t.infScrollable?t.rows=t.rows.concat(e.rows):t.rows=e.rows,t.totalPages=e.navPageCount,t.length=e.length,t.bottomLoader=!1,t.lists.typeMeasure=Object.assign({},e.typeMeasureList),t.lists.industry=Object.assign({},e.industryList),t.lists.status=Object.assign({},e.statusList)},onfailure:function(){console.log("no data")}})}(t),s=setTimeout((function(){}),1e3)}var c={data:function(){return{filterable:!0,filters:{}}},methods:{updateFilters:function(t){var e=t.filter,i=t.column;a.Vue.delete(this.filters,i),e&&a.Vue.set(this.filters,i,e)}},watch:{filters:function(){this.paginable&&(this.pageNumber=1),this.updateData instanceof Function&&this.updateData()}}},d={data:function(){return{sortable:!0,sorts:{},sortsOrder:[]}},methods:{updateSorts:function(t){var e=t.sort,i=t.column;"no"===e?i in this.sorts&&(a.Vue.delete(this.sorts,i),a.Vue.delete(this.sortsOrder,this.sortsOrder.indexOf(i))):(i in this.sorts?a.Vue.delete(this.sorts,i):this.sortsOrder.push(i),a.Vue.set(this.sorts,i,e))}},watch:{sorts:function(){this.paginable&&(this.pageNumber=1),this.updateData instanceof Function&&this.updateData()},sortsOrger:function(){this.paginable&&(this.pageNumber=1),this.updateData instanceof Function&&this.updateData()}}},v={data:function(){return{paginable:!0,pageSize:0,pageNumber:1}},methods:{updatePagination:function(t){var e=t.pageSize,i=t.pageNumber;this.pageSize=e,this.pageNumber=i}},watch:{pageSize:function(){this.updateData instanceof Function&&this.updateData()},pageNumber:function(){this.updateData instanceof Function&&this.updateData()}}},p={data:function(){return{infScrollable:!0,infScrollViewportHeight:0,infScrollBottomPosition:0}},created:function(){this.infScrollUpdateViewportHeight(),this.infScrollUpdateCurrentPosition(),window.addEventListener("resize",this.infScrollUpdateViewportHeight),window.addEventListener("scroll",this.infScrollUpdateCurrentPosition),this.infScrollable&&(this.infScrollBottomAnchor=document.querySelector("#infScrollBottomAnchor"),this.infScrollUpdateBottomPosition(),window.addEventListener("resize",this.infScrollUpdateBottomPosition))},unmounted:function(){window.removeEventListener("resize",this.infScrollUpdateViewportHeight),window.removeEventListener("scroll",this.infScrollUpdateCurrentPosition),this.infScrollable&&window.removeEventListener("resize",this.infScrollUpdateBottomPosition)},methods:{infScrollUpdateViewportHeight:function(){this.infScrollViewportHeight=document.documentElement.clientHeight},infScrollUpdateBottomPosition:function(){this.infScrollBottomPosition=this.infScrollBottomAnchor.getBoundingClientRect().top+window.pageYOffset},infScrollUpdateCurrentPosition:function(){var t=window.pageYOffset,e=this.infScrollViewportHeight,i=this.infScrollBottomPosition,o=this.infScrollTriggerOffset;this.infScrollable&&i-t-e<o&&this.updateData(!0)}},watch:{infScrollable:function(){var t=this;this.infScrollable?this.$nextTick((function(){t.infScrollBottomAnchor=document.querySelector("#infScrollBottomAnchor"),t.infScrollUpdateBottomPosition(),window.addEventListener("resize",t.infScrollUpdateBottomPosition)})):window.removeEventListener("resize",this.infScrollUpdateBottomPosition)},rows:function(){var t=this;this.infScrollable&&this.$nextTick((function(){t.infScrollUpdateBottomPosition()}))}}},S={data:function(){return{virtualScrollable:!0,virtualScrollViewportHeight:0,virtualScrollStartPosition:0,virtualScrollCurrentPosition:0}},created:function(){this.virtualScrollUpdateViewportHeight(),this.virtualScrollUpdateCurrentPosition(),window.addEventListener("resize",this.virtualScrollUpdateViewportHeight),window.addEventListener("scroll",this.virtualScrollUpdateCurrentPosition),this.virtualScrollable&&(this.virtualScrollTopFiller=document.querySelector("#virtualScrollTopFiller"),this.virtualScrollBottomFiller=document.querySelector("#virtualScrollBottomFiller"),this.virtualScrollUpdateStartPosition(),window.addEventListener("resize",this.virtualScrollUpdateStartPosition))},unmounted:function(){window.removeEventListener("resize",this.virtualScrollUpdateViewportHeight),window.removeEventListener("scroll",this.virtualScrollUpdateCurrentPosition),this.virtualScrollable&&window.removeEventListener("resize",this.virtualScrollUpdateStartPosition)},computed:{virtualScrollListSize:function(){return this.virtualScrollRowHeight*this.rows.length},virtualScrollListPosition:function(){return this.virtualScrollCurrentPosition-this.virtualScrollStartPosition},virtualScrollTopFillerCount:function(){var t=this.virtualScrollListPosition,e=this.virtualScrollRowHeight,i=this.virtualScrollBufferSize,o=Math.floor(t/e)-i;return o>0?o:0},virtualScrollViewportCount:function(){var t=this.virtualScrollRowHeight,e=this.virtualScrollBufferSize,i=this.virtualScrollViewportHeight;return Math.ceil(i/t)+2*e},virtualScrollBottomFillerCount:function(){var t=this.virtualScrollTopFillerCount,e=this.virtualScrollViewportCount,i=this.rows.length-t-e;return i>0?i:0},virtualScrollTopFillerSize:function(){return this.virtualScrollTopFillerCount*this.virtualScrollRowHeight},virtualScrollBottomFillerSize:function(){return this.virtualScrollBottomFillerCount*this.virtualScrollRowHeight},virtualScrollRows:function(){var t=this.virtualScrollTopFillerCount,e=this.virtualScrollViewportCount;return this.rows.slice(t,t+e)}},methods:{virtualScrollUpdateViewportHeight:function(){this.virtualScrollViewportHeight=document.documentElement.clientHeight},virtualScrollUpdateStartPosition:function(){this.virtualScrollStartPosition=this.virtualScrollTopFiller.getBoundingClientRect().top+window.pageYOffset},virtualScrollUpdateCurrentPosition:function(){this.virtualScrollCurrentPosition=window.pageYOffset},virtualScrollGetKey:function(t,e){return(e+this.virtualScrollTopFillerCount)%this.virtualScrollViewportCount}},watch:{virtualScrollable:function(){var t=this;this.virtualScrollable?this.$nextTick((function(){t.virtualScrollTopFiller=document.querySelector("#virtualScrollTopFiller"),t.virtualScrollBottomFiller=document.querySelector("#virtualScrollBottomFiller"),t.virtualScrollUpdateStartPosition(),window.addEventListener("resize",t.virtualScrollUpdateStartPosition)})):window.removeEventListener("resize",this.virtualScrollUpdateStartPosition)}}};a.Vue.component("bx-table",{template:'\n\t\t<div>\n\t\t\t<div>\n\t\t\t\tИспользовать бесконечный скролл\n\t\t\t\t<input\n\t\t\t\t\ttype="checkbox"\n\t\t\t\t\tv-model="infScrollable"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\tИспользовать виртуальный скролл\n\t\t\t\t<input\n\t\t\t\t\ttype="checkbox"\n\t\t\t\t\tv-model="virtualScrollable"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<bx-paginators\n\t\t\t\tv-if="!infScrollable"\n\t\t\t\tv-bind:pageSize="pageSize"\n\t\t\t\tv-bind:pageNumber="pageNumber"\n\t\t\t\tv-bind:totalPages="totalPages"\n\t\t\t\t@paginate="updatePagination($event)"\n\t\t\t/>\n\t\t\t<bx-vue-table\n\t\t\t\tv-bind:rows="computedRows"\n\t\t\t\tv-bind:columns="columns"\n\t\t\t\tv-bind:columnsHeads="columnsHeads"\n\t\t\t\tv-bind:getKey="computedGetKey"\n\t\t\t\tv-bind:defaultHeadClass="{ [\'table-head\']: true }"\n\t\t\t\tv-bind:defaultCellClass="{ [\'table-cell\']: true }"\n\t\t\t\tv-bind:useVirtualScroll="virtualScrollable"\n\t\t\t\tv-bind:virtualScrollHeight="20"\n\t\t\t\tv-bind:virtualScrollCount="25"\n\t\t\t\tclass="table"\n\t\t\t>\n\t\t\t\t<template v-if="virtualScrollable" v-slot:start-tbody>\n\t\t\t\t\t<tr\n\t\t\t\t\t\tv-bind:colspan="rowSize"\n\t\t\t\t\t\tid="virtualScrollTopFiller"\n\t\t\t\t\t\tv-bind:style="{height: `${virtualScrollTopFillerSize}px`}"\n\t\t\t\t\t/>\n\t\t\t\t</template>\n\t\t\t\t\n\t\t\t\t<template v-for="column in columns" v-slot:[`${column}-head`]="{head}">\n\t\t\t\t\t<bx-table-head v-bind:head="head" v-bind:key="column">\n\t\t\t\t\t\t<template v-if="column === \'announcementDate\'" v-slot:sorter\n\t\t\t\t\t\t\t><bx-sorters\n\t\t\t\t\t\t\t\tv-bind:sort="sorts[column]"\n\t\t\t\t\t\t\t\tv-bind:column="column"\n\t\t\t\t\t\t\t\tv-bind:index="sortsIndexes[column]"\n\t\t\t\t\t\t\t\t@sort="updateSorts($event)"\n\t\t\t\t\t\t/></template>\n\t\t\t\t\t\t<template v-slot:filter\n\t\t\t\t\t\t\t><bx-filters\n\t\t\t\t\t\t\t\tv-bind:is="filtersComponents[column]"\n\t\t\t\t\t\t\t\tv-bind:filter="filters[column]"\n\t\t\t\t\t\t\t\tv-bind:column="column"\n\t\t\t\t\t\t\t\tv-bind:type="filtersTypes[column]"\n\t\t\t\t\t\t\t\t:values="lists[column]"\n\t\t\t\t\t\t\t\t@filter="updateFilters($event)"\n\t\t\t\t\t\t/></template>\n\t\t\t\t\t</bx-table-head>\n\t\t\t\t</template>\n\n\t\t\t\t\n\t\t\t\t<template v-slot:source-cell="{row}">\n\t\t\t\t\t<noindex>\n\t\t\t\t\t\t<a rel="nofollow" :href="`${row.source}`">{{ row.source }}</a>\n\t\t\t\t\t</noindex>\n\t\t\t\t</template>\n\n\t\t\t\t<template v-slot:end-tbody>\n\t\t\t\t\t<tr\n\t\t\t\t\t\tv-if="virtualScrollable"\n\t\t\t\t\t\tv-bind:colspan="rowSize"\n\t\t\t\t\t\tid="virtualScrollBottomFiller"\n\t\t\t\t\t\tv-bind:style="`height:${virtualScrollBottomFillerSize}px`"\n\t\t\t\t\t/>\n\t\t\t\t\t<tr\n\t\t\t\t\t\tv-if="infScrollable"\n\t\t\t\t\t\tv-bind:colspan="rowSize"\n\t\t\t\t\t\tid="infScrollBottomAnchor"\n\t\t\t\t\t/>\n\t\t\t\t\t<bx-loader v-if="bottomLoader" v-bind:colspan="rowSize" />\n\t\t\t\t</template>\n\t\t\t</bx-vue-table>\n\n\t\t\t<bx-paginators\n\t\t\t\tv-if="!infScrollable"\n\t\t\t\tv-bind:pageSize="pageSize"\n\t\t\t\tv-bind:pageNumber="pageNumber"\n\t\t\t\tv-bind:totalPages="totalPages"\n\t\t\t\t@paginate="updatePagination($event)"\n\t\t\t/>\n\t\t</div>\n\t',props:{url:""},data:function(){return{rows:[],columns:["typeMeasure","industry","status","description","announcementDate","validity","supportAmount","source"],lists:{typeMeasure:{0:""},industry:{},status:{}},columnsHeads:{typeMeasure:"Тип",industry:"Отрасль",status:"Статус",description:"Описание",announcementDate:"Дата объявления",validity:"Срок действия",supportAmount:"Сумма",source:"Источник"},filtersTypes:{typeMeasure:"select",industry:"select",status:"select",description:"",announcement_date:"",validity:"",supportAmount:"",source:""},filtersComponents:{typeMeasure:"bx-filters",industry:"bx-filters",status:"bx-filters",description:"",announcement_date:"",validity:"",supportAmount:"",source:""},bottomLoader:!1,pageSize:20,totalPages:0,infScrollable:!1,infScrollStartSize:10,infScrollStepSize:5,infScrollTriggerOffset:1e3,virtualScrollable:!1,virtualScrollBufferSize:10,virtualScrollRowHeight:20}},computed:{rowSize:function(){return this.columns.length},sortsIndexes:function(){return this.sortsOrder.reduce((function(t,e,i){return t[e]=i+1,t}),{})},computedRows:function(){return this.virtualScrollable?this.virtualScrollRows:this.rows},computedHeadLists:function(){return this.virtualScrollable?this.virtualScrollRows:this.rows},computedGetKey:function(){return this.virtualScrollable?this.virtualScrollGetKey:this.getKey},getKey:function(t){return t.id}},methods:{updateData:function(t){u(this,!t)}},created:function(){this.updateData()},watch:{infScrollable:function(){this.paginable=!this.infScrollable,this.updateData()}},mixins:[c,d,v,p,S]})}(this.BX.Denvic.Table=this.BX.Denvic.Table||{},BX.Denvic.Table,BX.Denvic.Table.Filters,BX.Denvic.Table,BX.Denvic.Table,BX.Denvic.Table,BX.Denvic.Table,BX);
//# sourceMappingURL=table.bundle.js.map
