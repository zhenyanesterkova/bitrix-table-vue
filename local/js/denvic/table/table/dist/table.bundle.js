this.BX=this.BX||{},this.BX.Denvic=this.BX.Denvic||{},function(t,i,e,l,o,n,r,a,s){"use strict";var c,u;function d(t,i){t.bottomLoader=!0,i&&(t.rows=[]),u&&(clearTimeout(u),u=null),u=setTimeout((function(){!function(t){var i,e;c.onmessage=function(i){t.rows=t.rows.concat(i.data.rows),t.totalPages=t.pageSize?Math.ceil(i.data.length/t.pageSize):1,t.bottomLoader=!1},t.infScrollable?e=(i=t.rows.length)?i+t.infScrollStepSize:t.infScrollStartSize:t.paginable&&(e=(i=t.pageSize*(t.pageNumber-1))+t.pageSize);var l={sorts:t.sorts,sortsOrder:t.sortsOrder,filters:t.filters,startIndex:i,endIndex:e};c.postMessage(l)}(t)}),1e3)}a=a&&a.hasOwnProperty("default")?a.default:a,window.Worker&&(c=new Worker("data-worker.js"));var v={data:function(){return{filterable:!0,filters:{}}},methods:{updateFilters:function(t){var i=t.filter,e=t.column;a.delete(this.filters,e),i&&a.set(this.filters,e,i)}},watch:{filters:function(){this.paginable&&(this.pageNumber=1),this.updateData instanceof Function&&this.updateData()}}},h={data:function(){return{sortable:!0,sorts:{},sortsOrder:[]}},methods:{updateSorts:function(t){var i=t.sort,e=t.column;"no"===i?e in this.sorts&&(s.Vue.delete(this.sorts,e),s.Vue.delete(this.sortsOrder,this.sortsOrder.indexOf(e))):(e in this.sorts?s.Vue.delete(this.sorts,e):this.sortsOrder.push(e),s.Vue.set(this.sorts,e,i))}},watch:{sorts:function(){this.paginable&&(this.pageNumber=1),this.updateData instanceof Function&&this.updateData()},sortsOrger:function(){this.paginable&&(this.pageNumber=1),this.updateData instanceof Function&&this.updateData()}}},S={data:function(){return{paginable:!0,pageSize:0,pageNumber:1}},methods:{updatePagination:function(t){var i=t.pageSize,e=t.pageNumber;this.pageSize=i,this.pageNumber=e}},watch:{pageSize:function(){this.updateData instanceof Function&&this.updateData()},pageNumber:function(){this.updateData instanceof Function&&this.updateData()}}},p={data:function(){return{infScrollable:!0,infScrollViewportHeight:0,infScrollBottomPosition:0}},created:function(){this.infScrollUpdateViewportHeight(),this.infScrollUpdateCurrentPosition(),window.addEventListener("resize",this.infScrollUpdateViewportHeight),window.addEventListener("scroll",this.infScrollUpdateCurrentPosition),this.infScrollable&&(this.infScrollBottomAnchor=document.querySelector("#infScrollBottomAnchor"),this.infScrollUpdateBottomPosition(),window.addEventListener("resize",this.infScrollUpdateBottomPosition))},unmounted:function(){window.removeEventListener("resize",this.infScrollUpdateViewportHeight),window.removeEventListener("scroll",this.infScrollUpdateCurrentPosition),this.infScrollable&&window.removeEventListener("resize",this.infScrollUpdateBottomPosition)},methods:{infScrollUpdateViewportHeight:function(){this.infScrollViewportHeight=document.documentElement.clientHeight},infScrollUpdateBottomPosition:function(){this.infScrollBottomPosition=this.infScrollBottomAnchor.getBoundingClientRect().top+window.pageYOffset},infScrollUpdateCurrentPosition:function(){var t=window.pageYOffset,i=this.infScrollViewportHeight,e=this.infScrollBottomPosition,l=this.infScrollTriggerOffset;this.infScrollable&&e-t-i<l&&this.updateData(!0)}},watch:{infScrollable:function(){var t=this;this.infScrollable?this.$nextTick((function(){t.infScrollBottomAnchor=document.querySelector("#infScrollBottomAnchor"),t.infScrollUpdateBottomPosition(),window.addEventListener("resize",t.infScrollUpdateBottomPosition)})):window.removeEventListener("resize",this.infScrollUpdateBottomPosition)},rows:function(){var t=this;this.infScrollable&&this.$nextTick((function(){t.infScrollUpdateBottomPosition()}))}}},f={data:function(){return{virtualScrollable:!0,virtualScrollViewportHeight:0,virtualScrollStartPosition:0,virtualScrollCurrentPosition:0}},created:function(){this.virtualScrollUpdateViewportHeight(),this.virtualScrollUpdateCurrentPosition(),window.addEventListener("resize",this.virtualScrollUpdateViewportHeight),window.addEventListener("scroll",this.virtualScrollUpdateCurrentPosition),this.virtualScrollable&&(this.virtualScrollTopFiller=document.querySelector("#virtualScrollTopFiller"),this.virtualScrollBottomFiller=document.querySelector("#virtualScrollBottomFiller"),this.virtualScrollUpdateStartPosition(),window.addEventListener("resize",this.virtualScrollUpdateStartPosition))},unmounted:function(){window.removeEventListener("resize",this.virtualScrollUpdateViewportHeight),window.removeEventListener("scroll",this.virtualScrollUpdateCurrentPosition),this.virtualScrollable&&window.removeEventListener("resize",this.virtualScrollUpdateStartPosition)},computed:{virtualScrollListSize:function(){return this.virtualScrollRowHeight*this.rows.length},virtualScrollListPosition:function(){return this.virtualScrollCurrentPosition-this.virtualScrollStartPosition},virtualScrollTopFillerCount:function(){var t=this.virtualScrollListPosition,i=this.virtualScrollRowHeight,e=this.virtualScrollBufferSize,l=Math.floor(t/i)-e;return l>0?l:0},virtualScrollViewportCount:function(){var t=this.virtualScrollRowHeight,i=this.virtualScrollBufferSize,e=this.virtualScrollViewportHeight;return Math.ceil(e/t)+2*i},virtualScrollBottomFillerCount:function(){var t=this.virtualScrollTopFillerCount,i=this.virtualScrollViewportCount,e=this.rows.length-t-i;return e>0?e:0},virtualScrollTopFillerSize:function(){return this.virtualScrollTopFillerCount*this.virtualScrollRowHeight},virtualScrollBottomFillerSize:function(){return this.virtualScrollBottomFillerCount*this.virtualScrollRowHeight},virtualScrollRows:function(){var t=this.virtualScrollTopFillerCount,i=this.virtualScrollViewportCount;return this.rows.slice(t,t+i)}},methods:{virtualScrollUpdateViewportHeight:function(){this.virtualScrollViewportHeight=document.documentElement.clientHeight},virtualScrollUpdateStartPosition:function(){this.virtualScrollStartPosition=this.virtualScrollTopFiller.getBoundingClientRect().top+window.pageYOffset},virtualScrollUpdateCurrentPosition:function(){this.virtualScrollCurrentPosition=window.pageYOffset},virtualScrollGetKey:function(t,i){return(i+this.virtualScrollTopFillerCount)%this.virtualScrollViewportCount}},watch:{virtualScrollable:function(){var t=this;this.virtualScrollable?this.$nextTick((function(){t.virtualScrollTopFiller=document.querySelector("#virtualScrollTopFiller"),t.virtualScrollBottomFiller=document.querySelector("#virtualScrollBottomFiller"),t.virtualScrollUpdateStartPosition(),window.addEventListener("resize",t.virtualScrollUpdateStartPosition)})):window.removeEventListener("resize",this.virtualScrollUpdateStartPosition)}}};s.Vue.component("bx-table",{template:'\n\t\t<div>\n\t\t\t<div>\n\t\t\t\tИспользовать бесконечный скролл\n\t\t\t\t<input\n\t\t\t\t\ttype="checkbox"\n\t\t\t\t\tv-model="infScrollable"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\tИспользовать виртуальный скролл\n\t\t\t\t<input\n\t\t\t\t\ttype="checkbox"\n\t\t\t\t\tv-model="virtualScrollable"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<bx-paginators\n\t\t\t\tv-if="!infScrollable"\n\t\t\t\tv-bind:pageSize="pageSize"\n\t\t\t\tv-bind:pageNumber="pageNumber"\n\t\t\t\tv-bind:totalPages="totalPages"\n\t\t\t\t@paginate="updatePagination($event)"\n\t\t\t/>\n\t\t\t<bx-vue-table\n\t\t\t\tv-bind:rows="computedRows"\n\t\t\t\tv-bind:columns="columns"\n\t\t\t\tv-bind:columnsHeads="columnsHeads"\n\t\t\t\tv-bind:getKey="computedGetKey"\n\t\t\t\tv-bind:defaultHeadClass="{ [\'table-head\']: true }"\n\t\t\t\tv-bind:defaultCellClass="{ [\'table-cell\']: true }"\n\t\t\t\tv-bind:useVirtualScroll="virtualScrollable"\n\t\t\t\tv-bind:virtualScrollHeight="20"\n\t\t\t\tv-bind:virtualScrollCount="25"\n\t\t\t\tclass="table"\n\t\t\t>\n\t\t\t\t<template v-if="virtualScrollable" v-slot:start-tbody>\n\t\t\t\t\t<tr\n\t\t\t\t\t\tv-bind:colspan="rowSize"\n\t\t\t\t\t\tid="virtualScrollTopFiller"\n\t\t\t\t\t\tv-bind:style="{height: virtualScrollTopFillerSize + \'px\'}"\n\t\t\t\t\t/>\n\t\t\t\t</template>\n\t\t\t\t<template v-for="column in columns" v-slot:[`${column}-head`]="{head}">\n\t\t\t\t\t<bx-table-head v-bind:head="head" v-bind:key="column">\n\t\t\t\t\t\t<template v-slot:sorter\n\t\t\t\t\t\t\t><bx-sorters\n\t\t\t\t\t\t\t\tv-bind:sort="sorts[column]"\n\t\t\t\t\t\t\t\tv-bind:column="column"\n\t\t\t\t\t\t\t\tv-bind:index="sortsIndexes[column]"\n\t\t\t\t\t\t\t\t@sort="updateSorts($event)"\n\t\t\t\t\t\t/></template>\n\t\t\t\t\t\t<template v-slot:filter\n\t\t\t\t\t\t\t><bx-filters\n\t\t\t\t\t\t\t\tv-bind:is="filtersComponents[column]"\n\t\t\t\t\t\t\t\tv-bind:filter="filters[column]"\n\t\t\t\t\t\t\t\tv-bind:column="column"\n\t\t\t\t\t\t\t\tv-bind:type="filtersTypes[column]"\n\t\t\t\t\t\t\t\t@filter="updateFilters($event)"\n\t\t\t\t\t\t/></template>\n\t\t\t\t\t</bx-table-head>\n\t\t\t\t</template>\n\n\t\t\t\t\n\t\t\t\t<template v-slot:email-cell="{row}">\n\t\t\t\t\t<a :href="`mailto:${row.email}`">{{ row.email }}</a>\n\t\t\t\t</template>\n\n\t\t\t\t<template v-slot:end-tbody>\n\t\t\t\t\t<tr\n\t\t\t\t\t\tv-if="virtualScrollable"\n\t\t\t\t\t\tv-bind:colspan="rowSize"\n\t\t\t\t\t\tid="virtualScrollBottomFiller"\n\t\t\t\t\t\tv-bind:style="`height:${virtualScrollBottomFillerSize}px`"\n\t\t\t\t\t/>\n\t\t\t\t\t<tr\n\t\t\t\t\t\tv-if="infScrollable"\n\t\t\t\t\t\tv-bind:colspan="rowSize"\n\t\t\t\t\t\tid="infScrollBottomAnchor"\n\t\t\t\t\t/>\n\t\t\t\t\t<bx-loader v-if="bottomLoader" v-bind:colspan="rowSize" />\n\t\t\t\t</template>\n\t\t\t</bx-vue-table>\n\n\t\t\t<bx-paginators\n\t\t\t\tv-if="!infScrollable"\n\t\t\t\tv-bind:pageSize="pageSize"\n\t\t\t\tv-bind:pageNumber="pageNumber"\n\t\t\t\tv-bind:totalPages="totalPages"\n\t\t\t\t@paginate="updatePagination($event)"\n\t\t\t/>\n\t\t</div>\n\t',data:function(){return{rows:[],columns:["id","age","name","login","email"],columnsHeads:{id:"ID",age:"Возраст",name:"Имя",login:"Логин",email:"EMail"},filtersTypes:{id:"number",age:"number",name:"text",login:"text",email:"text"},filtersComponents:{id:"bx-filters",age:"bx-filters",name:"bx-filters",login:"bx-filters",email:"bx-filters"},bottomLoader:!1,pageSize:20,totalPages:0,infScrollable:!1,infScrollStartSize:100,infScrollStepSize:50,infScrollTriggerOffset:1e3,virtualScrollable:!1,virtualScrollBufferSize:10,virtualScrollRowHeight:20}},computed:{rowSize:function(){return this.columns.length},sortsIndexes:function(){return this.sortsOrder.reduce((function(t,i,e){return t[i]=e+1,t}),{})},computedRows:function(){return this.virtualScrollable?this.virtualScrollRows:this.rows},computedGetKey:function(){return this.virtualScrollable?this.virtualScrollGetKey:this.getKey},getKey:function(t){return t.id}},methods:{updateData:function(t){d(this,!t)}},created:function(){this.updateData()},watch:{infScrollable:function(){this.paginable=!this.infScrollable,this.updateData()}},mixins:[v,h,S,p,f]})}(this.BX.Denvic.Table=this.BX.Denvic.Table||{},BX.Denvic.Table,BX.Denvic.Table.Filters,BX.Denvic.Table,BX.Denvic.Table,BX.Denvic.Table,BX.Denvic.Table,BX,BX);
//# sourceMappingURL=table.bundle.js.map
